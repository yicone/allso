"use strict";function getHash(){return location.hash?location.hash.substring(1):""}function getQueryVariable(e){for(var t=window.location.search.substring(1),s=t.split("&"),a=0;a<s.length;a++){var o=s[a].split("=");if(decodeURIComponent(o[0])==e)return decodeURIComponent(o[1])}console.log("Query variable %s not found",e)}function saveState(){localStorage.allso_state=JSON.stringify(state)}function isEngineExist(e){return engines.some(function(t){return Object.keys(t)==e})}function getEngineConfig(e){var t=engines.find(function(t){return Object.keys(t)==e});return t[e]}function set(e,t){localStorage["X-Frame-Options"]||["Google","微博","Evernote"].indexOf(t)>=0&&$("#myModal").modal("show"),isEngineExist(t)?(state.engines[e]=t,saveState()):t=state.engines[e];var s=getEngineConfig(t);set_url[e]=s[0],set_top[e]=s[2],set_left[e]=s[3],set_foot[e]=s[4],$(".engine-brand img").eq(e).attr("src",s[1]),need_scale=!0}function doSearch(e){console.log("search",e);var t=$.trim($soinput[0].value);""!==t?(2!==state.show_side&&e!==state.show_side&&(state.show_side=2,scale()),0===e?$a[0].src=getUrl(0):(void 0===e&&($a[0].src=getUrl(0)),rightSearch()),window.document.title=t+" - 虫洞搜索"):(location=location.origin+"?q=",window.document.title="虫洞搜索 - 享受搜索的乐趣"),need_scale&&scale(),$progress.addClass("progress-bar-striped active"),window.setTimeout(function(){$progress.removeClass("progress-bar-striped active")},2e3)}function change_state(e){var t=e?0:1;2==state.show_side?(state.show_side=t,set_left[t]=0):state.show_side=2,scale(),2==state.show_side&&doSearch()}function scale(){var e=$("body").width(),t=$(window).height(),s=$("nav.navbar").height(),a=e/2;2==state.show_side?($a.fadeIn("fast").animate({"margin-left":set_left[0],width:a-set_left[0]},"fast"),$b.fadeIn("fast").animate({"margin-left":a+set_left[1],width:a-set_left[1]},"fast"),$progress[0].style.width="50%",$progress[1].style.width="50%"):0==state.show_side?($a.fadeIn("fast").animate({"margin-left":set_left[0],width:e-set_left[0]},"fast"),$b.fadeOut("fast"),$progress[0].style.width="75%",$progress[1].style.width="25%"):($a.fadeOut("fast"),$b.fadeIn("fast").animate({"margin-left":set_left[1],width:e-set_left[0]},"fast"),$progress[0].style.width="25%",$progress[1].style.width="75%"),$a.animate({"margin-top":set_top[0]+s,height:t-set_top[0]-s+set_foot[0]},"fast"),$b.animate({"margin-top":set_top[1]+s,height:t-set_top[1]-s+set_foot[1]},"fast"),need_scale=!1}function rightSearch(){var keywords=$($soinput[0]).val();if(keywords){var sl,tl;if(1==state.sync_mode)sl="en",tl="zh-CN";else{if(2!=state.sync_mode)return $($soinput[1]).val(keywords),void($b[0].src=getUrl(1));sl="zh-CN",tl="en"}var translate_url="http://api.gadn.in/gtrans?sl="+sl+"&tl="+tl+"&dt=t&q="+keywords;$.ajax({url:translate_url,dataType:"text",success:function success(data){var obj=eval(data),r=obj[0][0][0];$($soinput[1]).val(r),$b[0].src=getUrl(1)},error:function(e,t,s){console.error(e,t,s)}})}}function getUrl(e){var t=$.trim($soinput[e].value),s=set_url[e]+encodeURIComponent(t);return"Evernote"==state.engines[e]&&(s+="&"),s}var $soinput=$(".soinput"),$progress=$("div.progress>div"),$iframe=$("iframe.search_window"),$a=$("#a"),$b=$("#b"),engines=[{Google:["https://www.google.com/search?q=","https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png",-76,-120,87]},{Ask:["https://www.search.ask.com/web?q=","https://www.search.ask.com/assets/b/a-logo-small.png",-60,-120,120]},{Quora:["https://www.quora.com/search?q=","https://qsf.ec.quoracdn.net/-3-images.logo.wordmark_default.svg-26-32753849bf197b54.svg",0,0,0]},{"搜狗":["https://www.sogou.com/web?query=","https://img01.sogoucdn.com/app/a/100520122/0c6aeb64_jieguo.png",0,0,127]},{"必应":["https://cn.bing.com/search?setmkt=zh-cn&setlang=zh-cn&q=","https://cn.bing.com/sa/simg/CN_Logo_Gray.png",-72,-80,60]},{"微博":["http://s.weibo.com/weibo/","http://img.t.sinajs.cn/t6/style/images/global_nav/WB_logo.png?id=1404211047727",-180,0,163]},{"360搜索":["https://www.haosou.com/s?q=","https://p.ssl.qhimg.com/t0184e4ce3cb83220c1.png",0,-10,80]},{"百度":["https://www.baidu.com/s?wd=","https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superman/img/logo_top_ca79a146.png",-45,-90,70]},{GitHub:["https://github.com/search?q=","http://www.hack.institute/events/connected-car/img/github-logo-white.png",-130,0,200]},{Instapaper:["https://www.instapaper.com/search?q=","https://qph.ec.quoracdn.net/main-qimg-81323e136c3a148d9d74ac3ed060b4c2",0,0,0]},{Evernote:["https://www.evernote.com/Home.action#ses=1&sh=5&sds=5&x=","https://evernote.com/media/img/brand-guide/evernote-logos/Evernote_H.png",0,0,0]},{Wunderlist:["https://www.wunderlist.com/webapp#/search/","https://dr0wv9n0kx6h5.cloudfront.net/664cb69d34d0ef040ff8a446e429bce8feb54b41/site/images/logo-big.png",0,0,0]}],need_scale=!0,set_url=[],set_top=[0,0],set_left=[0,0],set_foot=[0,0],$engines=$(".engines"),default_state={engines:["Ask","搜狗"],autoSO:!0,show_side:2,sync_mode:0},state=$.extend({},default_state);if(void 0!==localStorage.allso_state){var data=localStorage.allso_state;state=JSON.parse(data)}console.log("launch engines:",state.engines),scale(),$engines.each(function(e){for(var t in engines){var s=engines[t],a=e,o=Object.keys(s)[0],n='<li><a onclick="set('+a+",'"+o+"'); doSearch("+a+');">'+o+"</a></li>";$(this).append(n),"百度"!=o&&"Quora"!=o&&"GitHub"!=o||$(this).append('<li role="separator" class="divider"></li>')}}),$($(".sync-mode>a")[state.sync_mode]).addClass("btn-danger");for(var i in state.engines){var engine_key=state.engines[i];set(i,engine_key)}$($(".modal-footer>button").get(1)).click(function(){localStorage["X-Frame-Options"]=!0,$("#myModal").modal("hide")}),function(){if(location.search){var e=getQueryVariable("q");$soinput.val(e),doSearch()}}(),$(window).resize(function(){scale()}),$soinput.each(function(e){$(this).on("input",function(){state.autoSO&&(0==e?doSearch():rightSearch())}),$(this).bind("enterKey",function(t){var s=$(this).val();location=location.origin+"?q="+s,0==e&&rightSearch()}),$(this).keyup(function(e){13==e.keyCode&&$(this).trigger("enterKey")})}),$(".sync-mode>a").each(function(e){$(this).click({index:e},function(t){$(".sync-mode>a").removeClass("btn-danger"),$(this).addClass("btn-danger"),state.sync_mode=e,saveState(),rightSearch()})}),$("div.loading").fadeOut("fast");
//# sourceMappingURL=main.js.map
