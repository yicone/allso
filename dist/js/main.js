"use strict";function getHash(){return location.hash?location.hash.substring(1):""}function getQueryVariable(t){for(var e=window.location.search.substring(1),s=e.split("&"),a=0;a<s.length;a++){var o=s[a].split("=");if(decodeURIComponent(o[0])==t)return decodeURIComponent(o[1])}console.log("Query variable %s not found",t)}function EnginesConfig(){this.ENGINES=[{Google:["https://www.google.com/search?q=${k}","https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png",-76,-120,87]},{Twitter:["https://twitter.com/search?q=${k}","https://pbs.twimg.com/profile_images/968232588958560256/IfOqS8l2.jpg",-76,-120,87]},{Ask:["https://www.search.ask.com/web?q=${k}","https://www.search.ask.com/assets/b/a-logo-small.png",-60,-120,120]},{Quora:["https://www.quora.com/search?q=${k}","https://qsf.ec.quoracdn.net/-3-images.logo.wordmark_default.svg-26-32753849bf197b54.svg",0,0,0]},{"搜狗":["https://www.sogou.com/web?query=${k}","https://img01.sogoucdn.com/app/a/100520122/0c6aeb64_jieguo.png",0,0,127]},{"必应":["https://cn.bing.com/search?setmkt=zh-cn&setlang=zh-cn&q=${k}","https://cn.bing.com/sa/simg/CN_Logo_Gray.png",-72,-80,60]},{"微博":["http://s.weibo.com/weibo/${k}","http://img.t.sinajs.cn/t6/style/images/global_nav/WB_logo.png?id=1404211047727",-180,0,163]},{"360搜索":["https://www.haosou.com/s?q=${k}","https://p.ssl.qhimg.com/t0184e4ce3cb83220c1.png",0,-10,80]},{"百度":["https://www.baidu.com/s?wd=${k}","https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superman/img/logo_top_ca79a146.png",-45,-90,70]},{"极客搜索":["https://s.geekbang.org/search/c=0/k=${k}/t=","http://read.html5.qq.com/image?src=forum&q=5&r=0&imgflag=7&imageUrl=http://mmbiz.qpic.cn/mmbiz_png/8NUG2LLiagCZOc4yRJkDPgAnJgtEQKV8tgicPwwEMtwpYZvicPI3gD8kX0ZsWWU9T9dsUfCso64EVC2C9dEC88LDw/0.png",-120,0,200]},{GitHub:["https://github.com/search?q=${k}","http://www.hack.institute/events/connected-car/img/github-logo-white.png",-130,0,200]},{Instapaper:["https://www.instapaper.com/search?q=${k}","https://qph.ec.quoracdn.net/main-qimg-81323e136c3a148d9d74ac3ed060b4c2",0,0,0]},{Evernote:["https://www.evernote.com/Home.action#ses=1&sh=5&sds=5&x=${k}","https://evernote.com/media/img/brand-guide/evernote-logos/Evernote_H.png",0,0,0]},{Wunderlist:["https://www.wunderlist.com/webapp#/search/${k}","https://dr0wv9n0kx6h5.cloudfront.net/664cb69d34d0ef040ff8a446e429bce8feb54b41/site/images/logo-big.png",0,0,0]}]}function saveState(){localStorage.allso_state=JSON.stringify(_state)}function set(t,e){window.electronFlag||localStorage["X-Frame-Options"]||["Google","微博","Evernote"].indexOf(e)>=0&&$("#myModal").modal("show"),_enginesConfig.exists(e)?(_state.enginePair[t]=e,saveState()):e=_state.enginePair[t];var s=_enginesConfig.get(e);set_url[t]=s[0],set_top[t]=s[2],set_left[t]=s[3],set_foot[t]=s[4],$(".engine-brand img").eq(t).attr("src",s[1]),need_scale=!0}function doSearch(t){console.log("search",t);var e=$.trim($soinput[0].value);""!==e?(2!==_state.show_side&&t!==_state.show_side&&(_state.show_side=2,scale()),0===t?$a[0].src=getUrl(0):(void 0===t&&($a[0].src=getUrl(0)),rightSearch()),window.document.title=e+" - 虫洞搜索"):window.document.title="虫洞搜索 - 享受搜索的乐趣",need_scale&&scale(),$progress.addClass("progress-bar-striped active"),window.setTimeout(function(){$progress.removeClass("progress-bar-striped active")},2e3)}function change_state(t){var e=t?0:1;2==_state.show_side?(_state.show_side=e,set_left[e]=0):_state.show_side=2,scale(),2==_state.show_side&&doSearch()}function scale(){var t=$("body").width(),e=$(window).height(),s=$("nav.navbar").height(),a=t/2;2==_state.show_side?($a.fadeIn("fast").animate({"margin-left":set_left[0],width:a-set_left[0]},"fast"),$b.fadeIn("fast").animate({"margin-left":a+set_left[1],width:a-set_left[1]},"fast"),$progress[0].style.width="50%",$progress[1].style.width="50%"):0==_state.show_side?($a.fadeIn("fast").animate({"margin-left":set_left[0],width:t-set_left[0]},"fast"),$b.fadeOut("fast"),$progress[0].style.width="75%",$progress[1].style.width="25%"):($a.fadeOut("fast"),$b.fadeIn("fast").animate({"margin-left":set_left[1],width:t-set_left[0]},"fast"),$progress[0].style.width="25%",$progress[1].style.width="75%"),$a.animate({"margin-top":set_top[0]+s,height:e-set_top[0]-s+set_foot[0]},"fast"),$b.animate({"margin-top":set_top[1]+s,height:e-set_top[1]-s+set_foot[1]},"fast"),need_scale=!1}function rightSearch(){var t=$($soinput[0]).val();if(t){var e,s;if(1==_state.sync_mode)e="en",s="zh-CN";else{if(2!=_state.sync_mode)return $($soinput[1]).val(t),void($b[0].src=getUrl(1));e="zh-CN",s="en"}var a="https://romantic-bartik-04cd0f.netlify.com/.netlify/functions/gtrans?sl="+e+"&tl="+s+"&dt=t&q="+t;$.ajax({url:a,dataType:"text",success:function(t){console.log("translate result:",t),$($soinput[1]).val(t),$b[0].src=getUrl(1)},error:function(e,s,a){console.error(e,s,a),$($soinput[1]).val(t),$b[0].src=getUrl(1)}})}}function getUrl(t){var e=$.trim($soinput[t].value),s=set_url[t].replace("${k}",encodeURIComponent(e));return"Evernote"==_state.enginePair[t]&&(s+="&"),s}EnginesConfig.prototype.exists=function(t){return this.ENGINES.some(function(e){return Object.keys(e)==t})},EnginesConfig.prototype.get=function(t){return this.ENGINES.find(function(e){return Object.keys(e)==t})[t]};var $soinput=$(".soinput"),$progress=$("div.progress>div"),$iframe=$("iframe.search_window"),$a=$("#a"),$b=$("#b"),_enginesConfig=new EnginesConfig,need_scale=!0,set_url=[],set_top=[0,0],set_left=[0,0],set_foot=[0,0],$engines=$(".engines"),default_state={enginePair:["Ask","搜狗"],autoSO:!0,show_side:2,sync_mode:0},_state;if(void 0!==localStorage.allso_state){var data=localStorage.allso_state;_state=JSON.parse(data)}var _state=$.extend({},default_state,_state);console.log("launch engines:",_state.enginePair),scale(),$engines.each(function(t){for(var e in _enginesConfig.ENGINES){var s=_enginesConfig.ENGINES[e],a=t,o=Object.keys(s)[0],n='<li><a onclick="set('+a+",'"+o+"'); doSearch("+a+');">'+o+"</a></li>";$(this).append(n),"百度"!=o&&"Quora"!=o&&"GitHub"!=o||$(this).append('<li role="separator" class="divider"></li>')}}),$($(".sync-mode>a")[_state.sync_mode]).addClass("btn-danger");for(var i in _state.enginePair){var engine_key=_state.enginePair[i];set(i,engine_key)}$($(".modal-footer>button").get(1)).click(function(){localStorage["X-Frame-Options"]=!0,$("#myModal").modal("hide")}),function(){if(location.search){var t=getQueryVariable("q");t=t.replace(/\+/g," ").replace(/%20/g," "),$soinput.val(t),doSearch()}}(),$(window).resize(function(){scale()}),$soinput.each(function(t){$(this).on("input",function(){_state.autoSO&&(0==t?doSearch():rightSearch())}),$(this).bind("enterKey",function(e){var s=$(this).val();location=location.origin+"?q="+s,0==t&&rightSearch()}),$(this).keyup(function(t){13==t.keyCode&&$(this).trigger("enterKey")})}),$(".sync-mode>a").each(function(t){$(this).click({index:t},function(e){$(".sync-mode>a").removeClass("btn-danger"),$(this).addClass("btn-danger"),_state.sync_mode=t,saveState(),rightSearch()})}),$("div.loading").fadeOut("fast");
//# sourceMappingURL=main.js.map
